import{w as ae,o as re,U as S,q as N,r as A,a as D,I as z,t as X,v as le,x as H,y as G,z as se,A as ue,T as ce,B as K,C as pe,D as de,E as ge}from"./index17.mjs";import{z as e}from"zod";function me({prompt:t,useLegacyFunctionCalling:s=!1,systemMessageMode:a="system"}){const d=[],u=[];for(const{role:p,content:n}of t)switch(p){case"system":{switch(a){case"system":{d.push({role:"system",content:n});break}case"developer":{d.push({role:"developer",content:n});break}case"remove":{u.push({type:"other",message:"system messages are removed for this model"});break}default:{const o=a;throw new Error(`Unsupported system message mode: ${o}`)}}break}case"user":{if(n.length===1&&n[0].type==="text"){d.push({role:"user",content:n[0].text});break}d.push({role:"user",content:n.map((o,i)=>{var r,h,c,_;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:{url:o.image instanceof URL?o.image.toString():`data:${(r=o.mimeType)!=null?r:"image/jpeg"};base64,${se(o.image)}`,detail:(c=(h=o.providerMetadata)==null?void 0:h.openai)==null?void 0:c.imageDetail}};case"file":{if(o.data instanceof URL)throw new S({functionality:"'File content parts with URL data' functionality not supported."});switch(o.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:o.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:o.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:(_=o.filename)!=null?_:`part-${i}.pdf`,file_data:`data:application/pdf;base64,${o.data}`}};default:throw new S({functionality:`File content part type ${o.mimeType} in user messages`})}}}})});break}case"assistant":{let o="";const i=[];for(const r of n)switch(r.type){case"text":{o+=r.text;break}case"tool-call":{i.push({id:r.toolCallId,type:"function",function:{name:r.toolName,arguments:JSON.stringify(r.args)}});break}}if(s){if(i.length>1)throw new S({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});d.push({role:"assistant",content:o,function_call:i.length>0?i[0].function:void 0})}else d.push({role:"assistant",content:o,tool_calls:i.length>0?i:void 0});break}case"tool":{for(const o of n)s?d.push({role:"function",name:o.toolName,content:JSON.stringify(o.result)}):d.push({role:"tool",tool_call_id:o.toolCallId,content:JSON.stringify(o.result)});break}default:{const o=p;throw new Error(`Unsupported role: ${o}`)}}return{messages:d,warnings:u}}function Z(t){var s,a;return(a=(s=t?.content)==null?void 0:s.map(({token:d,logprob:u,top_logprobs:p})=>({token:d,logprob:u,topLogprobs:p?p.map(({token:n,logprob:o})=>({token:n,logprob:o})):[]})))!=null?a:void 0}function F(t){switch(t){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var Y=e.object({error:e.object({message:e.string(),type:e.string().nullish(),param:e.any().nullish(),code:e.union([e.string(),e.number()]).nullish()})}),q=ue({errorSchema:Y,errorToMessage:t=>t.error.message});function V({id:t,model:s,created:a}){return{id:t??void 0,modelId:s??void 0,timestamp:a!=null?new Date(a*1e3):void 0}}function he({mode:t,useLegacyFunctionCalling:s=!1,structuredOutputs:a}){var d;const u=(d=t.tools)!=null&&d.length?t.tools:void 0,p=[];if(u==null)return{tools:void 0,tool_choice:void 0,toolWarnings:p};const n=t.toolChoice;if(s){const r=[];for(const c of u)c.type==="provider-defined"?p.push({type:"unsupported-tool",tool:c}):r.push({name:c.name,description:c.description,parameters:c.parameters});if(n==null)return{functions:r,function_call:void 0,toolWarnings:p};switch(n.type){case"auto":case"none":case void 0:return{functions:r,function_call:void 0,toolWarnings:p};case"required":throw new S({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:r,function_call:{name:n.toolName},toolWarnings:p}}}const o=[];for(const r of u)r.type==="provider-defined"?p.push({type:"unsupported-tool",tool:r}):o.push({type:"function",function:{name:r.name,description:r.description,parameters:r.parameters,strict:a?!0:void 0}});if(n==null)return{tools:o,tool_choice:void 0,toolWarnings:p};const i=n.type;switch(i){case"auto":case"none":case"required":return{tools:o,tool_choice:i,toolWarnings:p};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:n.toolName}},toolWarnings:p};default:{const r=i;throw new S({functionality:`Unsupported tool choice type: ${r}`})}}}var fe=class{constructor(t,s,a){this.specificationVersion="v1",this.modelId=t,this.settings=s,this.config=a}get supportsStructuredOutputs(){var t;return(t=this.settings.structuredOutputs)!=null?t:B(this.modelId)}get defaultObjectGenerationMode(){return be(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:t,prompt:s,maxTokens:a,temperature:d,topP:u,topK:p,frequencyPenalty:n,presencePenalty:o,stopSequences:i,responseFormat:r,seed:h,providerMetadata:c}){var _,k,f,g,l,m,y,x;const v=t.type,j=[];p!=null&&j.push({type:"unsupported-setting",setting:"topK"}),r?.type==="json"&&r.schema!=null&&!this.supportsStructuredOutputs&&j.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const I=this.settings.useLegacyFunctionCalling;if(I&&this.settings.parallelToolCalls===!0)throw new S({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(I&&this.supportsStructuredOutputs)throw new S({functionality:"structuredOutputs with useLegacyFunctionCalling"});const{messages:M,warnings:b}=me({prompt:s,useLegacyFunctionCalling:I,systemMessageMode:ve(this.modelId)});j.push(...b);const w={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:a,temperature:d,top_p:u,frequency_penalty:n,presence_penalty:o,response_format:r?.type==="json"?this.supportsStructuredOutputs&&r.schema!=null?{type:"json_schema",json_schema:{schema:r.schema,strict:!0,name:(_=r.name)!=null?_:"response",description:r.description}}:{type:"json_object"}:void 0,stop:i,seed:h,max_completion_tokens:(k=c?.openai)==null?void 0:k.maxCompletionTokens,store:(f=c?.openai)==null?void 0:f.store,metadata:(g=c?.openai)==null?void 0:g.metadata,prediction:(l=c?.openai)==null?void 0:l.prediction,reasoning_effort:(y=(m=c?.openai)==null?void 0:m.reasoningEffort)!=null?y:this.settings.reasoningEffort,messages:M};switch(B(this.modelId)?(w.temperature!=null&&(w.temperature=void 0,j.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),w.top_p!=null&&(w.top_p=void 0,j.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),w.frequency_penalty!=null&&(w.frequency_penalty=void 0,j.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),w.presence_penalty!=null&&(w.presence_penalty=void 0,j.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),w.logit_bias!=null&&(w.logit_bias=void 0,j.push({type:"other",message:"logitBias is not supported for reasoning models"})),w.logprobs!=null&&(w.logprobs=void 0,j.push({type:"other",message:"logprobs is not supported for reasoning models"})),w.top_logprobs!=null&&(w.top_logprobs=void 0,j.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),w.max_tokens!=null&&(w.max_completion_tokens==null&&(w.max_completion_tokens=w.max_tokens),w.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&w.temperature!=null&&(w.temperature=void 0,j.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),v){case"regular":{const{tools:E,tool_choice:L,functions:J,function_call:P,toolWarnings:O}=he({mode:t,useLegacyFunctionCalling:I,structuredOutputs:this.supportsStructuredOutputs});return{args:{...w,tools:E,tool_choice:L,functions:J,function_call:P},warnings:[...j,...O]}}case"object-json":return{args:{...w,response_format:this.supportsStructuredOutputs&&t.schema!=null?{type:"json_schema",json_schema:{schema:t.schema,strict:!0,name:(x=t.name)!=null?x:"response",description:t.description}}:{type:"json_object"}},warnings:j};case"object-tool":return{args:I?{...w,function_call:{name:t.tool.name},functions:[{name:t.tool.name,description:t.tool.description,parameters:t.tool.parameters}]}:{...w,tool_choice:{type:"function",function:{name:t.tool.name}},tools:[{type:"function",function:{name:t.tool.name,description:t.tool.description,parameters:t.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:j};default:{const E=v;throw new Error(`Unsupported type: ${E}`)}}}async doGenerate(t){var s,a,d,u,p,n,o,i;const{args:r,warnings:h}=this.getArgs(t),{responseHeaders:c,value:_,rawValue:k}=await N({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:A(this.config.headers(),t.headers),body:r,failedResponseHandler:q,successfulResponseHandler:H(_e),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:f,...g}=r,l=_.choices[0],m=(s=_.usage)==null?void 0:s.completion_tokens_details,y=(a=_.usage)==null?void 0:a.prompt_tokens_details,x={openai:{}};return m?.reasoning_tokens!=null&&(x.openai.reasoningTokens=m?.reasoning_tokens),m?.accepted_prediction_tokens!=null&&(x.openai.acceptedPredictionTokens=m?.accepted_prediction_tokens),m?.rejected_prediction_tokens!=null&&(x.openai.rejectedPredictionTokens=m?.rejected_prediction_tokens),y?.cached_tokens!=null&&(x.openai.cachedPromptTokens=y?.cached_tokens),{text:(d=l.message.content)!=null?d:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&l.message.function_call?[{toolCallType:"function",toolCallId:D(),toolName:l.message.function_call.name,args:l.message.function_call.arguments}]:(u=l.message.tool_calls)==null?void 0:u.map(v=>{var j;return{toolCallType:"function",toolCallId:(j=v.id)!=null?j:D(),toolName:v.function.name,args:v.function.arguments}}),finishReason:F(l.finish_reason),usage:{promptTokens:(n=(p=_.usage)==null?void 0:p.prompt_tokens)!=null?n:NaN,completionTokens:(i=(o=_.usage)==null?void 0:o.completion_tokens)!=null?i:NaN},rawCall:{rawPrompt:f,rawSettings:g},rawResponse:{headers:c,body:k},request:{body:JSON.stringify(r)},response:V(_),warnings:h,logprobs:Z(l.logprobs),providerMetadata:x}}async doStream(t){if(this.settings.simulateStreaming){const g=await this.doGenerate(t);return{stream:new ReadableStream({start(m){if(m.enqueue({type:"response-metadata",...g.response}),g.text&&m.enqueue({type:"text-delta",textDelta:g.text}),g.toolCalls)for(const y of g.toolCalls)m.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:y.toolCallId,toolName:y.toolName,argsTextDelta:y.args}),m.enqueue({type:"tool-call",...y});m.enqueue({type:"finish",finishReason:g.finishReason,usage:g.usage,logprobs:g.logprobs,providerMetadata:g.providerMetadata}),m.close()}}),rawCall:g.rawCall,rawResponse:g.rawResponse,warnings:g.warnings}}const{args:s,warnings:a}=this.getArgs(t),d={...s,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:u,value:p}=await N({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:A(this.config.headers(),t.headers),body:d,failedResponseHandler:q,successfulResponseHandler:G(ye),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:n,...o}=s,i=[];let r="unknown",h={promptTokens:void 0,completionTokens:void 0},c,_=!0;const{useLegacyFunctionCalling:k}=this.settings,f={openai:{}};return{stream:p.pipeThrough(new TransformStream({transform(g,l){var m,y,x,v,j,I,M,b,w,E,L,J;if(!g.success){r="error",l.enqueue({type:"error",error:g.error});return}const P=g.value;if("error"in P){r="error",l.enqueue({type:"error",error:P.error});return}if(_&&(_=!1,l.enqueue({type:"response-metadata",...V(P)})),P.usage!=null){const{prompt_tokens:T,completion_tokens:$,prompt_tokens_details:R,completion_tokens_details:C}=P.usage;h={promptTokens:T??void 0,completionTokens:$??void 0},C?.reasoning_tokens!=null&&(f.openai.reasoningTokens=C?.reasoning_tokens),C?.accepted_prediction_tokens!=null&&(f.openai.acceptedPredictionTokens=C?.accepted_prediction_tokens),C?.rejected_prediction_tokens!=null&&(f.openai.rejectedPredictionTokens=C?.rejected_prediction_tokens),R?.cached_tokens!=null&&(f.openai.cachedPromptTokens=R?.cached_tokens)}const O=P.choices[0];if(O?.finish_reason!=null&&(r=F(O.finish_reason)),O?.delta==null)return;const U=O.delta;U.content!=null&&l.enqueue({type:"text-delta",textDelta:U.content});const W=Z(O?.logprobs);W?.length&&(c===void 0&&(c=[]),c.push(...W));const Q=k&&U.function_call!=null?[{type:"function",id:D(),function:U.function_call,index:0}]:U.tool_calls;if(Q!=null)for(const T of Q){const $=T.index;if(i[$]==null){if(T.type!=="function")throw new z({data:T,message:"Expected 'function' type."});if(T.id==null)throw new z({data:T,message:"Expected 'id' to be a string."});if(((m=T.function)==null?void 0:m.name)==null)throw new z({data:T,message:"Expected 'function.name' to be a string."});i[$]={id:T.id,type:"function",function:{name:T.function.name,arguments:(y=T.function.arguments)!=null?y:""},hasFinished:!1};const C=i[$];((x=C.function)==null?void 0:x.name)!=null&&((v=C.function)==null?void 0:v.arguments)!=null&&(C.function.arguments.length>0&&l.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:C.id,toolName:C.function.name,argsTextDelta:C.function.arguments}),X(C.function.arguments)&&(l.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(j=C.id)!=null?j:D(),toolName:C.function.name,args:C.function.arguments}),C.hasFinished=!0));continue}const R=i[$];R.hasFinished||(((I=T.function)==null?void 0:I.arguments)!=null&&(R.function.arguments+=(b=(M=T.function)==null?void 0:M.arguments)!=null?b:""),l.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:R.id,toolName:R.function.name,argsTextDelta:(w=T.function.arguments)!=null?w:""}),((E=R.function)==null?void 0:E.name)!=null&&((L=R.function)==null?void 0:L.arguments)!=null&&X(R.function.arguments)&&(l.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(J=R.id)!=null?J:D(),toolName:R.function.name,args:R.function.arguments}),R.hasFinished=!0))}},flush(g){var l,m;g.enqueue({type:"finish",finishReason:r,logprobs:c,usage:{promptTokens:(l=h.promptTokens)!=null?l:NaN,completionTokens:(m=h.completionTokens)!=null?m:NaN},...f!=null?{providerMetadata:f}:{}})}})),rawCall:{rawPrompt:n,rawSettings:o},rawResponse:{headers:u},request:{body:JSON.stringify(d)},warnings:a}}},oe=e.object({prompt_tokens:e.number().nullish(),completion_tokens:e.number().nullish(),prompt_tokens_details:e.object({cached_tokens:e.number().nullish()}).nullish(),completion_tokens_details:e.object({reasoning_tokens:e.number().nullish(),accepted_prediction_tokens:e.number().nullish(),rejected_prediction_tokens:e.number().nullish()}).nullish()}).nullish(),_e=e.object({id:e.string().nullish(),created:e.number().nullish(),model:e.string().nullish(),choices:e.array(e.object({message:e.object({role:e.literal("assistant").nullish(),content:e.string().nullish(),function_call:e.object({arguments:e.string(),name:e.string()}).nullish(),tool_calls:e.array(e.object({id:e.string().nullish(),type:e.literal("function"),function:e.object({name:e.string(),arguments:e.string()})})).nullish()}),index:e.number(),logprobs:e.object({content:e.array(e.object({token:e.string(),logprob:e.number(),top_logprobs:e.array(e.object({token:e.string(),logprob:e.number()}))})).nullable()}).nullish(),finish_reason:e.string().nullish()})),usage:oe}),ye=e.union([e.object({id:e.string().nullish(),created:e.number().nullish(),model:e.string().nullish(),choices:e.array(e.object({delta:e.object({role:e.enum(["assistant"]).nullish(),content:e.string().nullish(),function_call:e.object({name:e.string().optional(),arguments:e.string().optional()}).nullish(),tool_calls:e.array(e.object({index:e.number(),id:e.string().nullish(),type:e.literal("function").nullish(),function:e.object({name:e.string().nullish(),arguments:e.string().nullish()})})).nullish()}).nullish(),logprobs:e.object({content:e.array(e.object({token:e.string(),logprob:e.number(),top_logprobs:e.array(e.object({token:e.string(),logprob:e.number()}))})).nullable()}).nullish(),finish_reason:e.string().nullish(),index:e.number()})),usage:oe}),Y]);function B(t){return t.startsWith("o")}function be(t){return t.startsWith("gpt-4o-audio-preview")}function ve(t){var s,a;return B(t)?(a=(s=we[t])==null?void 0:s.systemMessageMode)!=null?a:"developer":"system"}var we={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function ke({prompt:t,inputFormat:s,user:a="user",assistant:d="assistant"}){if(s==="prompt"&&t.length===1&&t[0].role==="user"&&t[0].content.length===1&&t[0].content[0].type==="text")return{prompt:t[0].content[0].text};let u="";t[0].role==="system"&&(u+=`${t[0].content}

`,t=t.slice(1));for(const{role:p,content:n}of t)switch(p){case"system":throw new le({message:"Unexpected system message in prompt: ${content}",prompt:t});case"user":{const o=n.map(i=>{switch(i.type){case"text":return i.text;case"image":throw new S({functionality:"images"})}}).join("");u+=`${a}:
${o}

`;break}case"assistant":{const o=n.map(i=>{switch(i.type){case"text":return i.text;case"tool-call":throw new S({functionality:"tool-call messages"})}}).join("");u+=`${d}:
${o}

`;break}case"tool":throw new S({functionality:"tool messages"});default:{const o=p;throw new Error(`Unsupported role: ${o}`)}}return u+=`${d}:
`,{prompt:u,stopSequences:[`
${a}:`]}}function ee(t){return t?.tokens.map((s,a)=>({token:s,logprob:t.token_logprobs[a],topLogprobs:t.top_logprobs?Object.entries(t.top_logprobs[a]).map(([d,u])=>({token:d,logprob:u})):[]}))}var xe=class{constructor(t,s,a){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=t,this.settings=s,this.config=a}get provider(){return this.config.provider}getArgs({mode:t,inputFormat:s,prompt:a,maxTokens:d,temperature:u,topP:p,topK:n,frequencyPenalty:o,presencePenalty:i,stopSequences:r,responseFormat:h,seed:c}){var _;const k=t.type,f=[];n!=null&&f.push({type:"unsupported-setting",setting:"topK"}),h!=null&&h.type!=="text"&&f.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:g,stopSequences:l}=ke({prompt:a,inputFormat:s}),m=[...l??[],...r??[]],y={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:d,temperature:u,top_p:p,frequency_penalty:o,presence_penalty:i,seed:c,prompt:g,stop:m.length>0?m:void 0};switch(k){case"regular":{if((_=t.tools)!=null&&_.length)throw new S({functionality:"tools"});if(t.toolChoice)throw new S({functionality:"toolChoice"});return{args:y,warnings:f}}case"object-json":throw new S({functionality:"object-json mode"});case"object-tool":throw new S({functionality:"object-tool mode"});default:{const x=k;throw new Error(`Unsupported type: ${x}`)}}}async doGenerate(t){const{args:s,warnings:a}=this.getArgs(t),{responseHeaders:d,value:u,rawValue:p}=await N({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:A(this.config.headers(),t.headers),body:s,failedResponseHandler:q,successfulResponseHandler:H(je),abortSignal:t.abortSignal,fetch:this.config.fetch}),{prompt:n,...o}=s,i=u.choices[0];return{text:i.text,usage:{promptTokens:u.usage.prompt_tokens,completionTokens:u.usage.completion_tokens},finishReason:F(i.finish_reason),logprobs:ee(i.logprobs),rawCall:{rawPrompt:n,rawSettings:o},rawResponse:{headers:d,body:p},response:V(u),warnings:a,request:{body:JSON.stringify(s)}}}async doStream(t){const{args:s,warnings:a}=this.getArgs(t),d={...s,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:u,value:p}=await N({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:A(this.config.headers(),t.headers),body:d,failedResponseHandler:q,successfulResponseHandler:G(Ce),abortSignal:t.abortSignal,fetch:this.config.fetch}),{prompt:n,...o}=s;let i="unknown",r={promptTokens:Number.NaN,completionTokens:Number.NaN},h,c=!0;return{stream:p.pipeThrough(new TransformStream({transform(_,k){if(!_.success){i="error",k.enqueue({type:"error",error:_.error});return}const f=_.value;if("error"in f){i="error",k.enqueue({type:"error",error:f.error});return}c&&(c=!1,k.enqueue({type:"response-metadata",...V(f)})),f.usage!=null&&(r={promptTokens:f.usage.prompt_tokens,completionTokens:f.usage.completion_tokens});const g=f.choices[0];g?.finish_reason!=null&&(i=F(g.finish_reason)),g?.text!=null&&k.enqueue({type:"text-delta",textDelta:g.text});const l=ee(g?.logprobs);l?.length&&(h===void 0&&(h=[]),h.push(...l))},flush(_){_.enqueue({type:"finish",finishReason:i,logprobs:h,usage:r})}})),rawCall:{rawPrompt:n,rawSettings:o},rawResponse:{headers:u},warnings:a,request:{body:JSON.stringify(d)}}}},je=e.object({id:e.string().nullish(),created:e.number().nullish(),model:e.string().nullish(),choices:e.array(e.object({text:e.string(),finish_reason:e.string(),logprobs:e.object({tokens:e.array(e.string()),token_logprobs:e.array(e.number()),top_logprobs:e.array(e.record(e.string(),e.number())).nullable()}).nullish()})),usage:e.object({prompt_tokens:e.number(),completion_tokens:e.number()})}),Ce=e.union([e.object({id:e.string().nullish(),created:e.number().nullish(),model:e.string().nullish(),choices:e.array(e.object({text:e.string(),finish_reason:e.string().nullish(),index:e.number(),logprobs:e.object({tokens:e.array(e.string()),token_logprobs:e.array(e.number()),top_logprobs:e.array(e.record(e.string(),e.number())).nullable()}).nullish()})),usage:e.object({prompt_tokens:e.number(),completion_tokens:e.number()}).nullish()}),Y]),Ie=class{constructor(t,s,a){this.specificationVersion="v1",this.modelId=t,this.settings=s,this.config=a}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var t;return(t=this.settings.maxEmbeddingsPerCall)!=null?t:2048}get supportsParallelCalls(){var t;return(t=this.settings.supportsParallelCalls)!=null?t:!0}async doEmbed({values:t,headers:s,abortSignal:a}){if(t.length>this.maxEmbeddingsPerCall)throw new ce({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:t});const{responseHeaders:d,value:u}=await N({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:A(this.config.headers(),s),body:{model:this.modelId,input:t,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:q,successfulResponseHandler:H(Se),abortSignal:a,fetch:this.config.fetch});return{embeddings:u.data.map(p=>p.embedding),usage:u.usage?{tokens:u.usage.prompt_tokens}:void 0,rawResponse:{headers:d}}}},Se=e.object({data:e.array(e.object({embedding:e.array(e.number())})),usage:e.object({prompt_tokens:e.number()}).nullish()}),Te={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},Re=new Set(["gpt-image-1"]),Me=class{constructor(t,s,a){this.modelId=t,this.settings=s,this.config=a,this.specificationVersion="v1"}get maxImagesPerCall(){var t,s;return(s=(t=this.settings.maxImagesPerCall)!=null?t:Te[this.modelId])!=null?s:1}get provider(){return this.config.provider}async doGenerate({prompt:t,n:s,size:a,aspectRatio:d,seed:u,providerOptions:p,headers:n,abortSignal:o}){var i,r,h,c;const _=[];d!=null&&_.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),u!=null&&_.push({type:"unsupported-setting",setting:"seed"});const k=(h=(r=(i=this.config._internal)==null?void 0:i.currentDate)==null?void 0:r.call(i))!=null?h:new Date,{value:f,responseHeaders:g}=await N({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:A(this.config.headers(),n),body:{model:this.modelId,prompt:t,n:s,size:a,...(c=p.openai)!=null?c:{},...Re.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:q,successfulResponseHandler:H(Oe),abortSignal:o,fetch:this.config.fetch});return{images:f.data.map(l=>l.b64_json),warnings:_,response:{timestamp:k,modelId:this.modelId,headers:g}}}},Oe=e.object({data:e.array(e.object({b64_json:e.string()}))}),Ae=e.object({include:e.array(e.string()).nullish(),language:e.string().nullish(),prompt:e.string().nullish(),temperature:e.number().min(0).max(1).nullish().default(0),timestampGranularities:e.array(e.enum(["word","segment"])).nullish().default(["segment"])}),te={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},qe=class{constructor(t,s){this.modelId=t,this.config=s,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:t,mediaType:s,providerOptions:a}){var d,u,p,n,o;const i=[],r=K({provider:"openai",providerOptions:a,schema:Ae}),h=new FormData,c=t instanceof Uint8Array?new Blob([t]):new Blob([pe(t)]);if(h.append("model",this.modelId),h.append("file",new File([c],"audio",{type:s})),r){const _={include:(d=r.include)!=null?d:void 0,language:(u=r.language)!=null?u:void 0,prompt:(p=r.prompt)!=null?p:void 0,temperature:(n=r.temperature)!=null?n:void 0,timestamp_granularities:(o=r.timestampGranularities)!=null?o:void 0};for(const k in _){const f=_[k];f!==void 0&&h.append(k,String(f))}}return{formData:h,warnings:i}}async doGenerate(t){var s,a,d,u,p,n;const o=(d=(a=(s=this.config._internal)==null?void 0:s.currentDate)==null?void 0:a.call(s))!=null?d:new Date,{formData:i,warnings:r}=this.getArgs(t),{value:h,responseHeaders:c,rawValue:_}=await de({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:A(this.config.headers(),t.headers),formData:i,failedResponseHandler:q,successfulResponseHandler:H(Ne),abortSignal:t.abortSignal,fetch:this.config.fetch}),k=h.language!=null&&h.language in te?te[h.language]:void 0;return{text:h.text,segments:(p=(u=h.words)==null?void 0:u.map(f=>({text:f.word,startSecond:f.start,endSecond:f.end})))!=null?p:[],language:k,durationInSeconds:(n=h.duration)!=null?n:void 0,warnings:r,response:{timestamp:o,modelId:this.modelId,headers:c,body:_}}}},Ne=e.object({text:e.string(),language:e.string().nullish(),duration:e.number().nullish(),words:e.array(e.object({word:e.string(),start:e.number(),end:e.number()})).nullish()});function Pe({prompt:t,systemMessageMode:s}){const a=[],d=[];for(const{role:u,content:p}of t)switch(u){case"system":{switch(s){case"system":{a.push({role:"system",content:p});break}case"developer":{a.push({role:"developer",content:p});break}case"remove":{d.push({type:"other",message:"system messages are removed for this model"});break}default:{const n=s;throw new Error(`Unsupported system message mode: ${n}`)}}break}case"user":{a.push({role:"user",content:p.map((n,o)=>{var i,r,h,c;switch(n.type){case"text":return{type:"input_text",text:n.text};case"image":return{type:"input_image",image_url:n.image instanceof URL?n.image.toString():`data:${(i=n.mimeType)!=null?i:"image/jpeg"};base64,${se(n.image)}`,detail:(h=(r=n.providerMetadata)==null?void 0:r.openai)==null?void 0:h.imageDetail};case"file":{if(n.data instanceof URL)throw new S({functionality:"File URLs in user messages"});switch(n.mimeType){case"application/pdf":return{type:"input_file",filename:(c=n.filename)!=null?c:`part-${o}.pdf`,file_data:`data:application/pdf;base64,${n.data}`};default:throw new S({functionality:"Only PDF files are supported in user messages"})}}}})});break}case"assistant":{for(const n of p)switch(n.type){case"text":{a.push({role:"assistant",content:[{type:"output_text",text:n.text}]});break}case"tool-call":{a.push({type:"function_call",call_id:n.toolCallId,name:n.toolName,arguments:JSON.stringify(n.args)});break}}break}case"tool":{for(const n of p)a.push({type:"function_call_output",call_id:n.toolCallId,output:JSON.stringify(n.result)});break}default:{const n=u;throw new Error(`Unsupported role: ${n}`)}}return{messages:a,warnings:d}}function ne({finishReason:t,hasToolCalls:s}){switch(t){case void 0:case null:return s?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return s?"tool-calls":"unknown"}}function $e({mode:t,strict:s}){var a;const d=(a=t.tools)!=null&&a.length?t.tools:void 0,u=[];if(d==null)return{tools:void 0,tool_choice:void 0,toolWarnings:u};const p=t.toolChoice,n=[];for(const i of d)switch(i.type){case"function":n.push({type:"function",name:i.name,description:i.description,parameters:i.parameters,strict:s?!0:void 0});break;case"provider-defined":switch(i.id){case"openai.web_search_preview":n.push({type:"web_search_preview",search_context_size:i.args.searchContextSize,user_location:i.args.userLocation});break;default:u.push({type:"unsupported-tool",tool:i});break}break;default:u.push({type:"unsupported-tool",tool:i});break}if(p==null)return{tools:n,tool_choice:void 0,toolWarnings:u};const o=p.type;switch(o){case"auto":case"none":case"required":return{tools:n,tool_choice:o,toolWarnings:u};case"tool":return p.toolName==="web_search_preview"?{tools:n,tool_choice:{type:"web_search_preview"},toolWarnings:u}:{tools:n,tool_choice:{type:"function",name:p.toolName},toolWarnings:u};default:{const i=o;throw new S({functionality:`Unsupported tool choice type: ${i}`})}}}var De=class{constructor(t,s){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=t,this.config=s}get provider(){return this.config.provider}getArgs({mode:t,maxTokens:s,temperature:a,stopSequences:d,topP:u,topK:p,presencePenalty:n,frequencyPenalty:o,seed:i,prompt:r,providerMetadata:h,responseFormat:c}){var _,k,f;const g=[],l=tt(this.modelId),m=t.type;p!=null&&g.push({type:"unsupported-setting",setting:"topK"}),i!=null&&g.push({type:"unsupported-setting",setting:"seed"}),n!=null&&g.push({type:"unsupported-setting",setting:"presencePenalty"}),o!=null&&g.push({type:"unsupported-setting",setting:"frequencyPenalty"}),d!=null&&g.push({type:"unsupported-setting",setting:"stopSequences"});const{messages:y,warnings:x}=Pe({prompt:r,systemMessageMode:l.systemMessageMode});g.push(...x);const v=K({provider:"openai",providerOptions:h,schema:nt}),j=(_=v?.strictSchemas)!=null?_:!0,I={model:this.modelId,input:y,temperature:a,top_p:u,max_output_tokens:s,...c?.type==="json"&&{text:{format:c.schema!=null?{type:"json_schema",strict:j,name:(k=c.name)!=null?k:"response",description:c.description,schema:c.schema}:{type:"json_object"}}},metadata:v?.metadata,parallel_tool_calls:v?.parallelToolCalls,previous_response_id:v?.previousResponseId,store:v?.store,user:v?.user,instructions:v?.instructions,...l.isReasoningModel&&(v?.reasoningEffort!=null||v?.reasoningSummary!=null)&&{reasoning:{...v?.reasoningEffort!=null&&{effort:v.reasoningEffort},...v?.reasoningSummary!=null&&{summary:v.reasoningSummary}}},...l.requiredAutoTruncation&&{truncation:"auto"}};switch(l.isReasoningModel&&(I.temperature!=null&&(I.temperature=void 0,g.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),I.top_p!=null&&(I.top_p=void 0,g.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),m){case"regular":{const{tools:M,tool_choice:b,toolWarnings:w}=$e({mode:t,strict:j});return{args:{...I,tools:M,tool_choice:b},warnings:[...g,...w]}}case"object-json":return{args:{...I,text:{format:t.schema!=null?{type:"json_schema",strict:j,name:(f=t.name)!=null?f:"response",description:t.description,schema:t.schema}:{type:"json_object"}}},warnings:g};case"object-tool":return{args:{...I,tool_choice:{type:"function",name:t.tool.name},tools:[{type:"function",name:t.tool.name,description:t.tool.description,parameters:t.tool.parameters,strict:j}]},warnings:g};default:{const M=m;throw new Error(`Unsupported type: ${M}`)}}}async doGenerate(t){var s,a,d,u,p,n,o;const{args:i,warnings:r}=this.getArgs(t),{responseHeaders:h,value:c,rawValue:_}=await N({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:A(this.config.headers(),t.headers),body:i,failedResponseHandler:q,successfulResponseHandler:H(e.object({id:e.string(),created_at:e.number(),model:e.string(),output:e.array(e.discriminatedUnion("type",[e.object({type:e.literal("message"),role:e.literal("assistant"),content:e.array(e.object({type:e.literal("output_text"),text:e.string(),annotations:e.array(e.object({type:e.literal("url_citation"),start_index:e.number(),end_index:e.number(),url:e.string(),title:e.string()}))}))}),e.object({type:e.literal("function_call"),call_id:e.string(),name:e.string(),arguments:e.string()}),e.object({type:e.literal("web_search_call")}),e.object({type:e.literal("computer_call")}),e.object({type:e.literal("reasoning"),summary:e.array(e.object({type:e.literal("summary_text"),text:e.string()}))})])),incomplete_details:e.object({reason:e.string()}).nullable(),usage:ie})),abortSignal:t.abortSignal,fetch:this.config.fetch}),k=c.output.filter(l=>l.type==="message").flatMap(l=>l.content).filter(l=>l.type==="output_text"),f=c.output.filter(l=>l.type==="function_call").map(l=>({toolCallType:"function",toolCallId:l.call_id,toolName:l.name,args:l.arguments})),g=(a=(s=c.output.find(l=>l.type==="reasoning"))==null?void 0:s.summary)!=null?a:null;return{text:k.map(l=>l.text).join(`
`),sources:k.flatMap(l=>l.annotations.map(m=>{var y,x,v;return{sourceType:"url",id:(v=(x=(y=this.config).generateId)==null?void 0:x.call(y))!=null?v:D(),url:m.url,title:m.title}})),finishReason:ne({finishReason:(d=c.incomplete_details)==null?void 0:d.reason,hasToolCalls:f.length>0}),toolCalls:f.length>0?f:void 0,reasoning:g?g.map(l=>({type:"text",text:l.text})):void 0,usage:{promptTokens:c.usage.input_tokens,completionTokens:c.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:h,body:_},request:{body:JSON.stringify(i)},response:{id:c.id,timestamp:new Date(c.created_at*1e3),modelId:c.model},providerMetadata:{openai:{responseId:c.id,cachedPromptTokens:(p=(u=c.usage.input_tokens_details)==null?void 0:u.cached_tokens)!=null?p:null,reasoningTokens:(o=(n=c.usage.output_tokens_details)==null?void 0:n.reasoning_tokens)!=null?o:null}},warnings:r}}async doStream(t){const{args:s,warnings:a}=this.getArgs(t),{responseHeaders:d,value:u}=await N({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:A(this.config.headers(),t.headers),body:{...s,stream:!0},failedResponseHandler:q,successfulResponseHandler:G(ze),abortSignal:t.abortSignal,fetch:this.config.fetch}),p=this;let n="unknown",o=NaN,i=NaN,r=null,h=null,c=null;const _={};let k=!1;return{stream:u.pipeThrough(new TransformStream({transform(f,g){var l,m,y,x,v,j,I,M;if(!f.success){n="error",g.enqueue({type:"error",error:f.error});return}const b=f.value;if(Xe(b))b.item.type==="function_call"&&(_[b.output_index]={toolName:b.item.name,toolCallId:b.item.call_id},g.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:b.item.call_id,toolName:b.item.name,argsTextDelta:b.item.arguments}));else if(Qe(b)){const w=_[b.output_index];w!=null&&g.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:w.toolCallId,toolName:w.toolName,argsTextDelta:b.delta})}else Ye(b)?(c=b.response.id,g.enqueue({type:"response-metadata",id:b.response.id,timestamp:new Date(b.response.created_at*1e3),modelId:b.response.model})):Be(b)?g.enqueue({type:"text-delta",textDelta:b.delta}):et(b)?g.enqueue({type:"reasoning",textDelta:b.delta}):Ge(b)&&b.item.type==="function_call"?(_[b.output_index]=void 0,k=!0,g.enqueue({type:"tool-call",toolCallType:"function",toolCallId:b.item.call_id,toolName:b.item.name,args:b.item.arguments})):Ke(b)?(n=ne({finishReason:(l=b.response.incomplete_details)==null?void 0:l.reason,hasToolCalls:k}),o=b.response.usage.input_tokens,i=b.response.usage.output_tokens,r=(y=(m=b.response.usage.input_tokens_details)==null?void 0:m.cached_tokens)!=null?y:r,h=(v=(x=b.response.usage.output_tokens_details)==null?void 0:x.reasoning_tokens)!=null?v:h):Ze(b)&&g.enqueue({type:"source",source:{sourceType:"url",id:(M=(I=(j=p.config).generateId)==null?void 0:I.call(j))!=null?M:D(),url:b.annotation.url,title:b.annotation.title}})},flush(f){f.enqueue({type:"finish",finishReason:n,usage:{promptTokens:o,completionTokens:i},...(r!=null||h!=null)&&{providerMetadata:{openai:{responseId:c,cachedPromptTokens:r,reasoningTokens:h}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:d},request:{body:JSON.stringify(s)},warnings:a}}},ie=e.object({input_tokens:e.number(),input_tokens_details:e.object({cached_tokens:e.number().nullish()}).nullish(),output_tokens:e.number(),output_tokens_details:e.object({reasoning_tokens:e.number().nullish()}).nullish()}),Ee=e.object({type:e.literal("response.output_text.delta"),delta:e.string()}),He=e.object({type:e.enum(["response.completed","response.incomplete"]),response:e.object({incomplete_details:e.object({reason:e.string()}).nullish(),usage:ie})}),Ue=e.object({type:e.literal("response.created"),response:e.object({id:e.string(),created_at:e.number(),model:e.string()})}),Le=e.object({type:e.literal("response.output_item.done"),output_index:e.number(),item:e.discriminatedUnion("type",[e.object({type:e.literal("message")}),e.object({type:e.literal("function_call"),id:e.string(),call_id:e.string(),name:e.string(),arguments:e.string(),status:e.literal("completed")})])}),Je=e.object({type:e.literal("response.function_call_arguments.delta"),item_id:e.string(),output_index:e.number(),delta:e.string()}),Fe=e.object({type:e.literal("response.output_item.added"),output_index:e.number(),item:e.discriminatedUnion("type",[e.object({type:e.literal("message")}),e.object({type:e.literal("function_call"),id:e.string(),call_id:e.string(),name:e.string(),arguments:e.string()})])}),Ve=e.object({type:e.literal("response.output_text.annotation.added"),annotation:e.object({type:e.literal("url_citation"),url:e.string(),title:e.string()})}),We=e.object({type:e.literal("response.reasoning_summary_text.delta"),item_id:e.string(),output_index:e.number(),summary_index:e.number(),delta:e.string()}),ze=e.union([Ee,He,Ue,Le,Je,Fe,Ve,We,e.object({type:e.string()}).passthrough()]);function Be(t){return t.type==="response.output_text.delta"}function Ge(t){return t.type==="response.output_item.done"}function Ke(t){return t.type==="response.completed"||t.type==="response.incomplete"}function Ye(t){return t.type==="response.created"}function Qe(t){return t.type==="response.function_call_arguments.delta"}function Xe(t){return t.type==="response.output_item.added"}function Ze(t){return t.type==="response.output_text.annotation.added"}function et(t){return t.type==="response.reasoning_summary_text.delta"}function tt(t){return t.startsWith("o")?t.startsWith("o1-mini")||t.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1}}var nt=e.object({metadata:e.any().nullish(),parallelToolCalls:e.boolean().nullish(),previousResponseId:e.string().nullish(),store:e.boolean().nullish(),user:e.string().nullish(),reasoningEffort:e.string().nullish(),strictSchemas:e.boolean().nullish(),instructions:e.string().nullish(),reasoningSummary:e.string().nullish()}),st=e.object({});function ot({searchContextSize:t,userLocation:s}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:t,userLocation:s},parameters:st}}var it={webSearchPreview:ot},at=e.object({instructions:e.string().nullish(),speed:e.number().min(.25).max(4).default(1).nullish()}),rt=class{constructor(t,s){this.modelId=t,this.config=s,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:t,voice:s="alloy",outputFormat:a="mp3",speed:d,instructions:u,providerOptions:p}){const n=[],o=K({provider:"openai",providerOptions:p,schema:at}),i={model:this.modelId,input:t,voice:s,response_format:"mp3",speed:d,instructions:u};if(a&&(["mp3","opus","aac","flac","wav","pcm"].includes(a)?i.response_format=a:n.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${a}. Using mp3 instead.`})),o){const r={};for(const h in r){const c=r[h];c!==void 0&&(i[h]=c)}}return{requestBody:i,warnings:n}}async doGenerate(t){var s,a,d;const u=(d=(a=(s=this.config._internal)==null?void 0:s.currentDate)==null?void 0:a.call(s))!=null?d:new Date,{requestBody:p,warnings:n}=this.getArgs(t),{value:o,responseHeaders:i,rawValue:r}=await N({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:A(this.config.headers(),t.headers),body:p,failedResponseHandler:q,successfulResponseHandler:ge(),abortSignal:t.abortSignal,fetch:this.config.fetch});return{audio:o,warnings:n,request:{body:JSON.stringify(p)},response:{timestamp:u,modelId:this.modelId,headers:i,body:r}}}};function lt(t={}){var s,a,d;const u=(s=ae(t.baseURL))!=null?s:"https://api.openai.com/v1",p=(a=t.compatibility)!=null?a:"compatible",n=(d=t.name)!=null?d:"openai",o=()=>({Authorization:`Bearer ${re({apiKey:t.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":t.organization,"OpenAI-Project":t.project,...t.headers}),i=(m,y={})=>new fe(m,y,{provider:`${n}.chat`,url:({path:x})=>`${u}${x}`,headers:o,compatibility:p,fetch:t.fetch}),r=(m,y={})=>new xe(m,y,{provider:`${n}.completion`,url:({path:x})=>`${u}${x}`,headers:o,compatibility:p,fetch:t.fetch}),h=(m,y={})=>new Ie(m,y,{provider:`${n}.embedding`,url:({path:x})=>`${u}${x}`,headers:o,fetch:t.fetch}),c=(m,y={})=>new Me(m,y,{provider:`${n}.image`,url:({path:x})=>`${u}${x}`,headers:o,fetch:t.fetch}),_=m=>new qe(m,{provider:`${n}.transcription`,url:({path:y})=>`${u}${y}`,headers:o,fetch:t.fetch}),k=m=>new rt(m,{provider:`${n}.speech`,url:({path:y})=>`${u}${y}`,headers:o,fetch:t.fetch}),f=(m,y)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return m==="gpt-3.5-turbo-instruct"?r(m,y):i(m,y)},g=m=>new De(m,{provider:`${n}.responses`,url:({path:y})=>`${u}${y}`,headers:o,fetch:t.fetch}),l=function(m,y){return f(m,y)};return l.languageModel=f,l.chat=i,l.completion=r,l.responses=g,l.embedding=h,l.textEmbedding=h,l.textEmbeddingModel=h,l.image=c,l.imageModel=c,l.transcription=_,l.transcriptionModel=_,l.speech=k,l.speechModel=k,l.tools=it,l}var pt=lt({compatibility:"strict"});export{pt as o};
